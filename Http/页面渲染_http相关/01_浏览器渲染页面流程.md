### 1. 浏览器渲染页面的流程

#### DOM(Document Object Model),CSSOM树的重绘

[浏览器渲染页面的流程(链接)](https://www.cnblogs.com/chenyoumei/p/9156849.html)
`DOM流程图`
---
![DOM流程图](https://www.w3cplus.com/sites/default/files/blogs/2018/1812/cssom-3.png)
`CSSDOM流程图`
---
![CSSDOM流程图](https://images2018.cnblogs.com/blog/1227776/201806/1227776-20180611113449533-1302562356.png)
![CSSDOM流程图](https://images2018.cnblogs.com/blog/1227776/201806/1227776-20180611113210061-2009638399.png)

----

#### 关键渲染路径（Critical Rendering Path）
[关键渲染路径(链接)](https://zhuanlan.zhihu.com/p/29418126)
* 浏览器渲染页面的过程
    1. DNS 查询
    2. TCP 连接
    3. HTTP 请求即响应
    4. 服务器响应
    5. 客户端渲染

* 第五部分客户端渲染
    1. 处理 HTML 标记并构建 DOM 树。
    2. 处理 CSS 标记并构建 CSSOM 树。
    3. 将 DOM 与 CSSOM 合并成一个渲染树。
    4. 根据渲染树来布局，以计算每个节点的几何信息。
    5. 将各个节点绘制到屏幕上。
---
### 2. 页面的重绘（repaint）与重排（reflow）

* **`重绘（repaint）`**：屏幕的一部分要重绘。渲染树节点发生改变，但不影响该节点在页面当中的空间位置及大小。譬如某个div标签节点的背景颜色、字体颜色等等发生改变，但是该div标签节点的宽、高、内外边距并不发生变化，此时触发浏览器重绘（repaint）。

* **`重排(回流)（reflow）`** 当渲染树节点发生改变，影响了节点的几何属性（如宽、高、内边距、外边距、或是float、position、display：none;等等），导致节点位置发生变化，此时触发浏览器重排（reflow），需要重新生成渲染树。譬如JS为某个p标签节点添加新的样式："display:none;"。导致该p标签被隐藏起来，该p标签之后的所有节点位置都会发生改变。此时浏览器需要重新生成渲染树，重新布局，即重排（reflow）。

注意：重排必将引起重绘，而重绘不一定会引起重排。

#### 2.1何时回流引起重排？

当页面布局和几何属性改变时就需要重排。下述情况会发生浏览器重排：
1. 添加或者删除可见的DOM元素；
2. 元素位置改变——display、float、position、overflow等等；
3. 元素尺寸改变——边距、填充、边框、宽度和高度
4. 内容改变——比如文本改变或者图片大小改变而引起的计算值宽度和高度改变；
5. 页面渲染初始化；
6. 浏览器窗口尺寸改变——resize事件发生时；

#### 2.2如何减少和避免重排

Reflow 回流的成本比 Repaint重排 的成本高得多的多。一个节点的 Reflow 很有可能导致子节点，甚至父节点以及兄弟节点的 Reflow 。在一些高性能的电脑上也许还没什么，但是如果 Reflow 发生在手机上，那么这个过程是延慢加载和耗电的。----浏览器的渲染原理简介

1. 直接改变className，如果动态改变样式，则使用cssText（考虑没有优化的浏览器）；

2. 让要操作的元素进行”离线处理”，处理完后一起更新；

    * a) 使用DocumentFragment进行缓存操作,引发一次回流和重绘；
    * b) 使用display:none技术，只引发两次回流和重绘；
    * c) 使用cloneNode(true or false) 和 replaceChild 技术，引发一次回流和重绘；

3. 不要经常访问会引起浏览器flush队列的属性，如果你确实要访问，利用缓存；

4. 让元素脱离动画流，减少回流的Render Tree的规模；